import{r,f as O,h as I,s as P,k as A,m as D,j as e,d as $,n as C,B as G,o as B,L as v,p as L,M as N}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";const U=()=>{const[c,S]=r.useState('A simple "Hello World" React component with a button that shows an alert.'),[f,x]=r.useState([]),[u,h]=r.useState(""),[p,b]=r.useState(""),[n,i]=r.useState(null),[d,g]=r.useState(!1),[j,m]=r.useState(""),[l,o]=r.useState("CODE");r.useEffect(()=>{(async()=>{const s=await L();x(s),s.length>0&&i(s[0])})()},[]);const k=r.useCallback(async()=>{if(!c.trim()){m("Please enter a feature description.");return}g(!0),m(""),await O(),x([]),h(""),b(""),i(null),o("CODE");try{const t=await I(c);for(const s of t)await P(s);if(x(t),t.length>0){const s=t.find(a=>a.filePath.endsWith(".tsx")||a.filePath.endsWith(".jsx"));if(i(s||t[0]),s){const a=A(s.content);let w="";for await(const M of a)w+=M,h(w)}const T=t.map(a=>`File: ${a.filePath}

${a.content}`).join(`
---
`),E=D(T);let y="";for await(const a of E)y+=a,b(y)}}catch(t){const s=t instanceof Error?t.message:"An unknown error occurred.";m(`Failed to generate feature: ${s}`)}finally{g(!1)}},[c]),F=()=>{switch(l){case"TESTS":return e.jsx(N,{content:u});case"COMMIT":return e.jsx("pre",{className:"w-full h-full p-4 whitespace-pre-wrap font-sans text-sm text-text-primary",children:p});case"CODE":default:return n?e.jsx(N,{content:`\`\`\`tsx
${n.content}
\`\`\``}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-secondary",children:"Select a file to view its content."})}};return e.jsxs("div",{className:"h-full flex flex-col text-text-primary bg-surface",children:[e.jsx("header",{className:"p-4 border-b border-border flex-shrink-0",children:e.jsxs("h1",{className:"text-xl font-bold flex items-center",children:[e.jsx($,{}),e.jsx("span",{className:"ml-3",children:"AI Feature Builder"})]})}),e.jsxs("div",{className:"flex-grow flex min-h-0",children:[e.jsxs("aside",{className:"w-64 bg-surface border-r border-border p-4 flex flex-col",children:[e.jsx("h2",{className:"text-sm font-semibold text-text-secondary mb-2",children:"Generated Files"}),e.jsx("div",{className:"overflow-y-auto space-y-1",children:f.map(t=>e.jsxs("div",{onClick:()=>{i(t),o("CODE")},className:`flex items-center space-x-2 p-2 rounded-md cursor-pointer text-sm ${(n==null?void 0:n.filePath)===t.filePath&&l==="CODE"?"bg-primary/10 text-primary":"hover:bg-gray-100"}`,children:[e.jsx(C,{}),e.jsx("span",{children:t.filePath.split("/").pop()})]},t.filePath))})]}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-grow flex flex-col bg-background",children:[e.jsxs("div",{className:"border-b border-border flex items-center bg-surface",children:[e.jsxs("button",{onClick:()=>o("CODE"),className:`flex items-center gap-2 px-4 py-2 text-sm ${l==="CODE"?"bg-background border-b-2 border-primary text-text-primary":"text-text-secondary hover:bg-gray-50"}`,children:[e.jsx(C,{})," Code"]}),u&&e.jsxs("button",{onClick:()=>o("TESTS"),className:`flex items-center gap-2 px-4 py-2 text-sm ${l==="TESTS"?"bg-background border-b-2 border-primary text-text-primary":"text-text-secondary hover:bg-gray-50"}`,children:[e.jsx(G,{})," Tests"]}),p&&e.jsxs("button",{onClick:()=>o("COMMIT"),className:`flex items-center gap-2 px-4 py-2 text-sm ${l==="COMMIT"?"bg-background border-b-2 border-primary text-text-primary":"text-text-secondary hover:bg-gray-50"}`,children:[e.jsx(B,{})," Commit"]})]}),e.jsx("div",{className:"flex-grow p-2 overflow-auto",children:d&&!f.length?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(v,{})}):F()})]}),e.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-border bg-surface",children:[e.jsx("textarea",{value:c,onChange:t=>S(t.target.value),placeholder:"e.g., A user profile card with an avatar, name, and bio.",className:"w-full p-2 bg-background border border-border rounded-md resize-none text-sm h-20"}),e.jsx("button",{onClick:k,disabled:d,className:"btn-primary mt-2 w-full flex items-center justify-center gap-2 px-4 py-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(v,{})," Generating..."]}):"Generate Feature"}),j&&e.jsx("p",{className:"text-red-600 text-xs mt-2 text-center",children:j})]})]})]})]})};export{U as AiFeatureBuilder};
