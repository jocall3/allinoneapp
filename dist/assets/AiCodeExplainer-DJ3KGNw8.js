import{r,e as w,j as e,d as C,L as j,M as S}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";const k=`const bubbleSort = (arr) => {
  for (let i = 0; i < arr.length; i++) {
    for (let j = 0; j < arr.length - i - 1; j++) {
      if (arr[j] > arr[j + 1]) {
        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
      }
    }
  }
  return arr;
};`,L=n=>n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\b(const|let|var|function|return|if|for|=>|import|from|export|default)\b/g,'<span class="text-accent">$1</span>').replace(/(\`|'|")(.*?)(\`|'|")/g,'<span class="text-green-400">$1$2$3</span>').replace(/(\/\/.*)/g,'<span class="text-text-secondary/70 italic">$1</span>').replace(/(\{|\}|\(|\)|\[|\])/g,'<span class="text-text-secondary">$1</span>'),E=({initialCode:n})=>{const[l,p]=r.useState(n||k),[t,u]=r.useState(null),[c,f]=r.useState(!1),[d,x]=r.useState(""),[h,g]=r.useState("summary"),o=r.useRef(null),i=r.useRef(null),m=r.useCallback(async s=>{if(!s.trim()){x("Please enter some code to explain.");return}f(!0),x(""),u(null),g("summary");try{const a=await w(s);u(a)}catch(a){const v=a instanceof Error?a.message:"An unknown error occurred.";x(`Failed to get explanation: ${v}`)}finally{f(!1)}},[]);r.useEffect(()=>{n&&(p(n),m(n))},[n,m]);const y=()=>{i.current&&o.current&&(i.current.scrollTop=o.current.scrollTop,i.current.scrollLeft=o.current.scrollLeft)},b=r.useMemo(()=>L(l),[l]),N=()=>{if(!t)return null;switch(h){case"summary":return e.jsx(S,{content:t.summary});case"lineByLine":return e.jsx("div",{className:"space-y-3",children:t.lineByLine.map((s,a)=>e.jsxs("div",{className:"p-3 bg-background/50 rounded-md border border-border",children:[e.jsxs("p",{className:"font-mono text-xs text-primary mb-1",children:["Lines: ",s.lines]}),e.jsx("p",{className:"text-sm",children:s.explanation})]},a))});case"complexity":return e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Time Complexity:"})," ",e.jsx("span",{className:"font-mono text-warning",children:t.complexity.time})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Space Complexity:"})," ",e.jsx("span",{className:"font-mono text-warning",children:t.complexity.space})]})]});case"suggestions":return e.jsx("ul",{className:"list-disc list-inside space-y-2",children:t.suggestions.map((s,a)=>e.jsx("li",{children:s},a))})}};return e.jsxs("div",{className:"h-full flex flex-col p-4 sm:p-6 lg:p-8 text-text-primary",children:[e.jsxs("header",{className:"mb-6 flex-shrink-0",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center",children:[e.jsx(C,{}),e.jsx("span",{className:"ml-3",children:"AI Code Explainer"})]}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Get a detailed, structured analysis of any code snippet."})]}),e.jsxs("div",{className:"flex-grow grid grid-cols-1 md:grid-cols-2 gap-6 min-h-0",children:[e.jsxs("div",{className:"flex flex-col min-h-0",children:[e.jsx("label",{htmlFor:"code-input",className:"text-sm font-medium text-text-secondary mb-2",children:"Your Code"}),e.jsxs("div",{className:"relative flex-grow bg-surface border border-border rounded-md focus-within:ring-2 focus-within:ring-primary overflow-hidden",children:[e.jsx("textarea",{ref:o,id:"code-input",value:l,onChange:s=>p(s.target.value),onScroll:y,placeholder:"Paste your code here...",spellCheck:"false",className:"absolute inset-0 w-full h-full p-4 bg-transparent resize-none font-mono text-sm text-transparent caret-primary outline-none z-10"}),e.jsx("pre",{ref:i,"aria-hidden":"true",className:"absolute inset-0 w-full h-full p-4 font-mono text-sm text-text-primary pointer-events-none z-0 whitespace-pre-wrap overflow-auto no-scrollbar",dangerouslySetInnerHTML:{__html:b+`
`}})]}),e.jsx("div",{className:"mt-4 flex-shrink-0",children:e.jsx("button",{onClick:()=>m(l),disabled:c,className:"btn-primary w-full flex items-center justify-center px-6 py-3",children:c?e.jsx(j,{}):"Analyze Code"})})]}),e.jsxs("div",{className:"flex flex-col min-h-0",children:[e.jsx("label",{className:"text-sm font-medium text-text-secondary mb-2",children:"AI Analysis"}),e.jsxs("div",{className:"relative flex-grow flex flex-col bg-surface/50 border border-border rounded-md overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 flex border-b border-border",children:["summary","lineByLine","complexity","suggestions"].map(s=>e.jsx("button",{onClick:()=>g(s),disabled:!t,className:`px-4 py-2 text-sm font-medium capitalize transition-colors ${h===s?"bg-background text-primary font-semibold border-b-2 border-primary":"text-text-secondary hover:bg-surface-hover disabled:text-text-secondary/50"}`,children:s.replace(/([A-Z])/g," $1")},s))}),e.jsxs("div",{className:"p-4 flex-grow overflow-y-auto",children:[c&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(j,{})}),d&&e.jsx("p",{className:"text-danger",children:d}),t&&!c&&N(),!c&&!t&&!d&&e.jsx("div",{className:"text-text-secondary h-full flex items-center justify-center",children:"The analysis will appear here."})]})]})]})]})]})};export{E as AiCodeExplainer};
