import{r as o,j as e,ab as g}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";const d=({title:a,value:m})=>e.jsxs("div",{className:"bg-surface border border-border p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-text-secondary",children:a}),e.jsx("p",{className:"text-xl font-bold text-text-primary",children:m})]}),w=()=>{const[a,m]=o.useState([]),[i,h]=o.useState("duration"),[c,p]=o.useState("desc");o.useEffect(()=>{const s=performance.getEntriesByType("resource");m(s)},[]);const j=o.useMemo(()=>[...a].sort((s,r)=>{const t=s[i],l=r[i];return t<l?c==="asc"?-1:1:t>l?c==="asc"?1:-1:0}),[a,i,c]),{totalSize:f,totalDuration:x,maxDuration:b}=o.useMemo(()=>{const s=a.reduce((t,l)=>t+l.transferSize,0),r=Math.max(...a.map(t=>t.startTime+t.duration),0);return{totalSize:s,totalDuration:r,maxDuration:Math.max(...a.map(t=>t.duration),0)}},[a]),N=s=>{p(i===s&&c==="desc"?"asc":"desc"),h(s)},u=s=>{if(s===0)return"0 B";const r=1024,t=["B","KB","MB"],l=Math.floor(Math.log(s)/Math.log(r));return parseFloat((s/Math.pow(r,l)).toFixed(1))+" "+t[l]},n=({skey:s,label:r,className:t})=>e.jsxs("th",{onClick:()=>N(s),className:`p-2 text-left cursor-pointer hover:bg-gray-100 ${t}`,children:[r," ",i===s&&(c==="asc"?"▲":"▼")]});return e.jsxs("div",{className:"h-full flex flex-col p-4 sm:p-6 lg:p-8 text-text-primary",children:[e.jsxs("header",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center",children:[e.jsx(g,{}),e.jsx("span",{className:"ml-3",children:"Network Visualizer"})]}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Inspect network resources with a summary and waterfall chart."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsx(d,{title:"Total Requests",value:a.length}),e.jsx(d,{title:"Total Transferred",value:u(f)}),e.jsx(d,{title:"Finish Time",value:`${x.toFixed(0)}ms`}),e.jsx(d,{title:"Longest Request",value:`${b.toFixed(0)}ms`})]}),e.jsx("div",{className:"flex-grow overflow-auto bg-surface rounded-lg border border-border",children:e.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[e.jsx("thead",{className:"sticky top-0 bg-surface z-10",children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx(n,{skey:"name",label:"Name",className:"w-2/5"}),e.jsx(n,{skey:"initiatorType",label:"Type",className:"w-1/5"}),e.jsx(n,{skey:"transferSize",label:"Size",className:"w-1/5"}),e.jsx(n,{skey:"duration",label:"Time / Waterfall",className:"w-1/5"})]})}),e.jsx("tbody",{children:j.map((s,r)=>e.jsxs("tr",{className:"border-b border-border hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 text-primary truncate",title:s.name,children:s.name.split("/").pop()}),e.jsx("td",{className:"p-2",children:s.initiatorType}),e.jsx("td",{className:"p-2",children:u(s.transferSize)}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"w-12",children:[s.duration.toFixed(0),"ms"]}),e.jsx("div",{className:"flex-grow h-4 bg-gray-200 rounded overflow-hidden",children:e.jsx("div",{className:"h-4 bg-primary rounded",style:{marginLeft:`${s.startTime/x*100}%`,width:`${s.duration/x*100}%`},title:`Start: ${s.startTime.toFixed(0)}ms`})})]})})]},r))})]})})]})};export{w as NetworkVisualizer};
