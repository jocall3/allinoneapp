import{j as e,u as j,r as l,v as y,i as c,G as N}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";const f=()=>e.jsxs("div",{className:"flex items-center justify-center space-x-1","aria-label":"Loading",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse",style:{animationDelay:"0s"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse",style:{animationDelay:"0.4s"}})]}),v=()=>{const{state:b,dispatch:o}=j(),{githubToken:n,isGithubConnected:a,githubUser:d}=b,[x,u]=l.useState(n||""),[m,t]=l.useState("idle"),[p,i]=l.useState("");l.useEffect(()=>{n&&!a&&h(n)},[n]);const h=async s=>{if(!s.trim()){i("Please enter a token."),t("error");return}t("loading"),i("");try{const r=await y(s);c(s),o({type:"SET_GITHUB_TOKEN",payload:{token:s,user:r}}),t("success")}catch(r){i(r instanceof Error?`Invalid Token: ${r.message}`:"An unknown error occurred."),t("error"),c(""),o({type:"SET_GITHUB_TOKEN",payload:{token:null,user:null}})}},g=()=>{u(""),c(""),o({type:"SET_GITHUB_TOKEN",payload:{token:null,user:null}}),t("idle")};return e.jsxs("div",{className:"bg-surface border border-border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10",children:e.jsx(N,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-text-primary",children:"GitHub"}),a&&d?e.jsxs("p",{className:"text-sm text-green-600",children:["Connected as ",d.login]}):e.jsx("p",{className:"text-sm text-text-secondary",children:"Not Connected"})]})]}),a&&e.jsx("button",{onClick:g,className:"px-4 py-2 bg-red-500/10 text-red-600 font-semibold rounded-lg hover:bg-red-500/20",children:"Disconnect"})]}),!a&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[e.jsx("label",{htmlFor:"github-pat",className:"block text-sm font-medium text-text-secondary mb-1",children:"Personal Access Token (Classic)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"github-pat",type:"password",value:x,onChange:s=>u(s.target.value),placeholder:"ghp_...",className:"flex-grow p-2 bg-background border border-border rounded-md text-sm"}),e.jsx("button",{onClick:()=>h(x),disabled:m==="loading",className:"btn-primary px-6 py-2 flex items-center justify-center min-w-[100px]",children:m==="loading"?e.jsx(f,{}):"Connect"})]}),p&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:p}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:"Your token is stored only in your browser's local storage. Required scopes: `repo`, `read:user`."})]})]})},E=()=>e.jsx("div",{className:"h-full p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight",children:"Connections"}),e.jsx("p",{className:"mt-2 text-lg text-text-secondary",children:"Manage your GitHub connection to unlock powerful workflows."})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(v,{})})]})});export{E as Connections};
