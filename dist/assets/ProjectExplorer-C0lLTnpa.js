import{u as y,r as n,a as N,b as w,j as e,F as x,L as E,D as S,c as C}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";const f=({node:l,onFileSelect:a})=>{const[r,t]=n.useState(!0);return l.isDirectory?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 py-1 cursor-pointer hover:bg-gray-100 rounded",onClick:()=>t(!r),children:[e.jsx("div",{className:`transform transition-transform ${r?"rotate-90":""}`,children:"â–¶"}),e.jsx(x,{}),e.jsx("span",{className:"font-semibold",children:l.name})]}),r&&l.children&&e.jsx("div",{className:"pl-4 border-l border-border ml-3",children:l.children.map(o=>e.jsx(f,{node:o,onFileSelect:a},o.path))})]}):e.jsxs("div",{className:"flex items-center space-x-2 pl-4 py-1 cursor-pointer hover:bg-gray-100 rounded",onClick:()=>a(l.path),children:[e.jsx(S,{}),e.jsx("span",{children:l.name})]})},R=()=>{const{state:l,dispatch:a}=y(),{githubToken:r,selectedRepo:t,projectFiles:o}=l,[j,p]=n.useState([]),[m,d]=n.useState(null),[h,c]=n.useState(""),[b,u]=n.useState(null);n.useEffect(()=>{r?(d("repos"),c(""),N().then(p).catch(s=>c(s.message)).finally(()=>d(null))):p([])},[r]),n.useEffect(()=>{t&&r&&(d("tree"),c(""),u(null),w(t.owner,t.repo).then(s=>a({type:"LOAD_PROJECT_FILES",payload:s})).catch(s=>c(s.message)).finally(()=>d(null)))},[t,r,a]);const g=async s=>{if(t)try{const i=await C(t.owner,t.repo,s);u(i)}catch(i){c(i.message)}};return r?e.jsxs("div",{className:"h-full flex flex-col text-text-primary",children:[e.jsxs("header",{className:"p-4 border-b border-border flex-shrink-0",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center",children:[e.jsx(x,{}),e.jsx("span",{className:"ml-3",children:"Project Explorer"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("select",{value:t?`${t.owner}/${t.repo}`:"",onChange:s=>{const[i,v]=s.target.value.split("/");a({type:"SET_SELECTED_REPO",payload:{owner:i,repo:v}})},className:"w-full p-2 bg-surface border border-border rounded-md text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:m==="repos"?"Loading...":"Select a repository"}),j.map(s=>e.jsx("option",{value:s.full_name,children:s.full_name},s.id))]})}),h&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:h})]}),e.jsxs("div",{className:"flex-grow flex min-h-0",children:[e.jsxs("aside",{className:"w-1/3 bg-background border-r border-border p-4 overflow-y-auto",children:[m==="tree"&&e.jsx("div",{className:"flex justify-center",children:e.jsx(E,{})}),o&&e.jsx(f,{node:o,onFileSelect:g})]}),e.jsx("main",{className:"flex-1 bg-surface",children:e.jsx("pre",{className:"w-full h-full p-4 text-sm overflow-auto whitespace-pre-wrap",children:e.jsx("code",{children:b??"Select a file to view its content."})})})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-text-secondary p-4",children:[e.jsx(x,{}),e.jsx("h2",{className:"text-lg font-semibold mt-2",children:"Connect to GitHub"}),e.jsx("p",{children:'Please go to the "Connections" tab and provide a Personal Access Token to explore your repositories.'})]})};export{R as ProjectExplorer};
