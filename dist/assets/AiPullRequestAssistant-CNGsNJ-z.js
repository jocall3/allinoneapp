import{r as y,_,j as s,$ as J,L as V}from"./index-Br2PlERp.js";import"https://esm.sh/octokit@4.0.2";function I(){}I.prototype={diff:function(t,n){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.callback;typeof a=="function"&&(o=a,a={}),this.options=a;var i=this;function l(u){return o?(setTimeout(function(){o(void 0,u)},0),!0):u}t=this.castInput(t),n=this.castInput(n),t=this.removeEmpty(this.tokenize(t)),n=this.removeEmpty(this.tokenize(n));var c=n.length,m=t.length,d=1,f=c+m;a.maxEditLength&&(f=Math.min(f,a.maxEditLength));var x=(r=a.timeout)!==null&&r!==void 0?r:1/0,L=Date.now()+x,h=[{oldPos:-1,lastComponent:void 0}],T=this.extractCommon(h[0],n,t,0);if(h[0].oldPos+1>=m&&T+1>=c)return l([{value:this.join(n),count:n.length}]);var v=-1/0,C=1/0;function g(){for(var u=Math.max(v,-d);u<=Math.min(C,d);u+=2){var b=void 0,A=h[u-1],N=h[u+1];A&&(h[u-1]=void 0);var p=!1;if(N){var w=N.oldPos-u;p=N&&0<=w&&w<c}var $=A&&A.oldPos+1<m;if(!p&&!$){h[u]=void 0;continue}if(!$||p&&A.oldPos+1<N.oldPos?b=i.addToPath(N,!0,void 0,0):b=i.addToPath(A,void 0,!0,1),T=i.extractCommon(b,n,t,u),b.oldPos+1>=m&&T+1>=c)return l(U(i,b.lastComponent,n,t,i.useLongestToken));h[u]=b,b.oldPos+1>=m&&(C=Math.min(C,u-1)),T+1>=c&&(v=Math.max(v,u+1))}d++}if(o)(function u(){setTimeout(function(){if(d>f||Date.now()>L)return o();g()||u()},0)})();else for(;d<=f&&Date.now()<=L;){var j=g();if(j)return j}},addToPath:function(t,n,r,a){var o=t.lastComponent;return o&&o.added===n&&o.removed===r?{oldPos:t.oldPos+a,lastComponent:{count:o.count+1,added:n,removed:r,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+a,lastComponent:{count:1,added:n,removed:r,previousComponent:o}}},extractCommon:function(t,n,r,a){for(var o=n.length,i=r.length,l=t.oldPos,c=l-a,m=0;c+1<o&&l+1<i&&this.equals(n[c+1],r[l+1]);)c++,l++,m++;return m&&(t.lastComponent={count:m,previousComponent:t.lastComponent}),t.oldPos=l,c},equals:function(t,n){return this.options.comparator?this.options.comparator(t,n):t===n||this.options.ignoreCase&&t.toLowerCase()===n.toLowerCase()},removeEmpty:function(t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(t[r]);return n},castInput:function(t){return t},tokenize:function(t){return t.split("")},join:function(t){return t.join("")}};function U(e,t,n,r,a){for(var o=[],i;t;)o.push(t),i=t.previousComponent,delete t.previousComponent,t=i;o.reverse();for(var l=0,c=o.length,m=0,d=0;l<c;l++){var f=o[l];if(f.removed){if(f.value=e.join(r.slice(d,d+f.count)),d+=f.count,l&&o[l-1].added){var L=o[l-1];o[l-1]=o[l],o[l]=L}}else{if(!f.added&&a){var x=n.slice(m,m+f.count);x=x.map(function(T,v){var C=r[d+v];return C.length>T.length?C:T}),f.value=e.join(x)}else f.value=e.join(n.slice(m,m+f.count));m+=f.count,f.added||(d+=f.count)}}var h=o[c-1];return c>1&&typeof h.value=="string"&&(h.added||h.removed)&&e.equals("",h.value)&&(o[c-2].value+=h.value,o.pop()),o}var R=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,O=/\S/,B=new I;B.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!O.test(e)&&!O.test(t)};B.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&R.test(t[n])&&R.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var q=new I;q.tokenize=function(e){this.options.stripTrailingCr&&(e=e.replace(/\r\n/g,`
`));var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var a=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=a:(this.options.ignoreWhitespace&&(a=a.trim()),t.push(a))}return t};function Z(e,t,n){return q.diff(e,t,n)}var Q=new I;Q.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var X=new I;X.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function E(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E=function(t){return typeof t}:E=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(e)}function z(e){return Y(e)||K(e)||ee(e)||te()}function Y(e){if(Array.isArray(e))return F(e)}function K(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ee(e,t){if(e){if(typeof e=="string")return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}}function F(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne=Object.prototype.toString,D=new I;D.useLongestToken=!0;D.tokenize=q.tokenize;D.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,a=r===void 0?function(o,i){return typeof i>"u"?n:i}:r;return typeof e=="string"?e:JSON.stringify(S(e,null,null,a),a,"  ")};D.equals=function(e,t){return I.prototype.equals.call(D,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};function S(e,t,n,r,a){t=t||[],n=n||[],r&&(e=r(a,e));var o;for(o=0;o<t.length;o+=1)if(t[o]===e)return n[o];var i;if(ne.call(e)==="[object Array]"){for(t.push(e),i=new Array(e.length),n.push(i),o=0;o<e.length;o+=1)i[o]=S(e[o],t,n,r,a);return t.pop(),n.pop(),i}if(e&&e.toJSON&&(e=e.toJSON()),E(e)==="object"&&e!==null){t.push(e),i={},n.push(i);var l=[],c;for(c in e)e.hasOwnProperty(c)&&l.push(c);for(l.sort(),o=0;o<l.length;o+=1)c=l[o],i[c]=S(e[c],t,n,r,c);t.pop(),n.pop()}else i=e;return i}var M=new I;M.tokenize=function(e){return e.slice()};M.join=M.removeEmpty=function(e){return e};function re(e,t,n,r,a,o,i){i||(i={}),typeof i.context>"u"&&(i.context=4);var l=Z(n,r,i);if(!l)return;l.push({value:"",lines:[]});function c(C){return C.map(function(g){return" "+g})}for(var m=[],d=0,f=0,x=[],L=1,h=1,T=function(g){var j=l[g],u=j.lines||j.value.replace(/\n$/,"").split(`
`);if(j.lines=u,j.added||j.removed){var b;if(!d){var A=l[g-1];d=L,f=h,A&&(x=i.context>0?c(A.lines.slice(-i.context)):[],d-=x.length,f-=x.length)}(b=x).push.apply(b,z(u.map(function(W){return(j.added?"+":"-")+W}))),j.added?h+=u.length:L+=u.length}else{if(d)if(u.length<=i.context*2&&g<l.length-2){var N;(N=x).push.apply(N,z(c(u)))}else{var p,w=Math.min(u.length,i.context);(p=x).push.apply(p,z(c(u.slice(0,w))));var $={oldStart:d,oldLines:L-d+w,newStart:f,newLines:h-f+w,lines:x};if(g>=l.length-2&&u.length<=i.context){var H=/\n$/.test(n),G=/\n$/.test(r),P=u.length==0&&x.length>$.oldLines;!H&&P&&n.length>0&&x.splice($.oldLines,0,"\\ No newline at end of file"),(!H&&!P||!G)&&x.push("\\ No newline at end of file")}m.push($),d=0,f=0,x=[]}L+=u.length,h+=u.length}},v=0;v<l.length;v++)T(v);return{oldFileName:e,newFileName:t,oldHeader:a,newHeader:o,hunks:m}}function k(e){if(Array.isArray(e))return e.map(k).join(`
`);var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+(typeof e.oldHeader>"u"?"":"	"+e.oldHeader)),t.push("+++ "+e.newFileName+(typeof e.newHeader>"u"?"":"	"+e.newHeader));for(var n=0;n<e.hunks.length;n++){var r=e.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),t.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),t.push.apply(t,r.lines)}return t.join(`
`)+`
`}function oe(e,t,n,r,a,o,i){return k(re(e,t,n,r,a,o,i))}function se(e,t,n,r,a,o){return oe(e,e,t,n,r,a,o)}const ie=`function Greeter(props) {
  return <h1>Hello, {props.name}!</h1>;
}`,ae=`function Greeter({ name, enthusiasmLevel = 1 }) {
  const punctuation = '!'.repeat(enthusiasmLevel);
  return <h1>Hello, {name}{punctuation}</h1>;
}`,ce=()=>{const[e,t]=y.useState(ie),[n,r]=y.useState(ae),[a,o]=y.useState(!1),[i,l]=y.useState(""),[c,m]=y.useState(""),[d,f]=y.useState(""),[x,L]=y.useState("feature/new-logic"),[h,T]=y.useState("main"),[v,C]=y.useState("feat"),[g,j]=y.useState(""),[u,b]=y.useState(`1. 
2. 
3.`),A=y.useCallback(async()=>{if(!e.trim()&&!n.trim()){l("Please provide code to generate a summary.");return}o(!0),l("");try{const p=se("component.tsx",e,n),w=await _(p);m(w.title),f(`${w.summary}

**Key Changes:**
${w.changes.map($=>`- ${$}`).join(`
`)}`)}catch(p){const w=p instanceof Error?p.message:"An unknown error occurred.";l(`Failed to generate summary: ${w}`)}finally{o(!1)}},[e,n]),N=y.useMemo(()=>`
# ${v}: ${c}
${g?`
**Closes:** ${g}
`:""}
**Branch:** \`${x}\` -> \`${h}\`

## Description
${d}

## Testing Steps
${u}
        `.trim(),[c,d,x,h,v,g,u]);return s.jsxs("div",{className:"h-full flex flex-col p-4 sm:p-6 lg:p-8 text-text-primary",children:[s.jsxs("header",{className:"mb-6",children:[s.jsxs("h1",{className:"text-3xl font-bold flex items-center",children:[s.jsx(J,{}),s.jsx("span",{className:"ml-3",children:"AI Pull Request Assistant"})]}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Generate a PR summary from code changes and populate a full template."})]}),s.jsxs("div",{className:"flex-grow grid grid-cols-1 lg:grid-cols-2 gap-6 min-h-0",children:[s.jsxs("div",{className:"flex flex-col gap-4 min-h-0",children:[s.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[s.jsx("label",{htmlFor:"before-code",className:"text-sm font-medium text-text-secondary mb-2",children:"Before"}),s.jsx("textarea",{id:"before-code",value:e,onChange:p=>t(p.target.value),className:"flex-grow p-4 bg-surface border border-border rounded-md resize-none font-mono text-sm"})]}),s.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[s.jsx("label",{htmlFor:"after-code",className:"text-sm font-medium text-text-secondary mb-2",children:"After"}),s.jsx("textarea",{id:"after-code",value:n,onChange:p=>r(p.target.value),className:"flex-grow p-4 bg-surface border border-border rounded-md resize-none font-mono text-sm"})]}),s.jsx("button",{onClick:A,disabled:a,className:"btn-primary w-full flex items-center justify-center px-6 py-3",children:a?s.jsx(V,{}):"Generate Title & Description"}),i&&s.jsx("p",{className:"text-red-500 text-xs text-center",children:i})]}),s.jsxs("div",{className:"flex flex-col gap-4 min-h-0",children:[s.jsxs("form",{className:"flex flex-col gap-2 overflow-y-auto pr-2 bg-surface border border-border p-4 rounded-lg h-1/2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"w-1/4",children:[s.jsx("label",{className:"block text-xs",children:"Type"}),s.jsxs("select",{value:v,onChange:p=>C(p.target.value),className:"w-full mt-1 p-1 rounded bg-background border border-border text-sm",children:[s.jsx("option",{children:"feat"}),s.jsx("option",{children:"fix"}),s.jsx("option",{children:"chore"}),s.jsx("option",{children:"docs"}),s.jsx("option",{children:"refactor"})]})]}),s.jsxs("div",{className:"w-3/4",children:[s.jsx("label",{className:"block text-xs",children:"Title"}),s.jsx("input",{type:"text",value:c,onChange:p=>m(p.target.value),className:"w-full mt-1 p-1 rounded bg-background border border-border text-sm"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs",children:"Description"}),s.jsx("textarea",{value:d,onChange:p=>f(p.target.value),className:"w-full mt-1 p-1 rounded bg-background border border-border resize-y h-24 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs",children:"Testing Steps"}),s.jsx("textarea",{value:u,onChange:p=>b(p.target.value),className:"w-full mt-1 p-1 rounded bg-background border border-border resize-y h-16 text-sm"})]})]}),s.jsxs("div",{className:"flex flex-col h-1/2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-text-secondary",children:"Markdown Preview"}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(N),className:"px-3 py-1 bg-gray-100 text-xs rounded-md hover:bg-gray-200",children:"Copy Markdown"})]}),s.jsx("div",{className:"relative flex-grow",children:s.jsx("pre",{className:"w-full h-full bg-background border border-border p-4 rounded-md text-sm overflow-auto whitespace-pre-wrap",children:N})})]})]})]})]})};export{ce as AiPullRequestAssistant};
