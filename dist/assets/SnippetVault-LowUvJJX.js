import{r as l,j as t,t as v,w as C,x as S,S as k,A as T,y as E}from"./index-Br2PlERp.js";import{u as D}from"./useLocalStorage-D6pLRcm0.js";import{d as I}from"./fileUtils-Dvg4vqd5.js";import"https://esm.sh/octokit@4.0.2";const A={javascript:"js",typescript:"ts",python:"py",css:"css",html:"html",json:"json",markdown:"md",plaintext:"txt"},R=()=>{const[n,i]=D("devcore_snippets",[{id:1,name:"React Hook Boilerplate",language:"javascript",code:`import { useState } from 'react';

const useCustomHook = () => {
  const [value, setValue] = useState(null);
  return { value, setValue };
};`,tags:["react","hook"]}]),[s,r]=l.useState(null),[u,p]=l.useState(!1),[c,g]=l.useState(""),[f,m]=l.useState(!1),o=l.useMemo(()=>{if(!c)return n;const e=c.toLowerCase();return n.filter(a=>a.name.toLowerCase().includes(e)||a.code.toLowerCase().includes(e)||a.tags&&a.tags.some(x=>x.toLowerCase().includes(e)))},[n,c]);l.useEffect(()=>{!s&&o.length>0&&r(o[0]),s&&r(n.find(e=>e.id===s.id)||null)},[n,s,o]);const d=e=>{i(n.map(a=>a.id===e.id?e:a)),r(e)},h=async()=>{if(s){p(!0);try{const e=E(s.code);let a="";for await(const x of e)a+=x,d({...s,code:a.replace(/^```(?:\w+\n)?/,"").replace(/```$/,"")})}finally{p(!1)}}},b=()=>{const e={id:Date.now(),name:"New Snippet",language:"plaintext",code:"",tags:[]};i([...n,e]),r(e)},y=e=>{i(n.filter(a=>a.id!==e)),(s==null?void 0:s.id)===e&&r(o.length>1?o[0]:null)},j=()=>{if(!s)return;const e=A[s.language]||"txt",a=`${s.name.replace(/\s/g,"_")}.${e}`;I(s.code,a)},w=e=>{s&&d({...s,name:e.target.value})},N=e=>{if(e.key==="Enter"&&s){const a=e.currentTarget.value.trim();a&&!s.tags.includes(a)&&d({...s,tags:[...s.tags??[],a]}),e.currentTarget.value=""}};return t.jsxs("div",{className:"h-full flex flex-col p-4 sm:p-6 lg:p-8 text-text-primary",children:[t.jsxs("header",{className:"mb-6",children:[t.jsxs("h1",{className:"text-3xl font-bold flex items-center",children:[t.jsx(v,{}),t.jsx("span",{className:"ml-3",children:"Snippet Vault"})]}),t.jsx("p",{className:"text-text-secondary mt-1",children:"Store, search, tag, and enhance your reusable code snippets with AI."})]}),t.jsxs("div",{className:"flex-grow flex gap-6 min-h-0",children:[t.jsxs("aside",{className:"w-1/3 bg-surface border border-border p-4 rounded-lg flex flex-col",children:[t.jsx("input",{type:"text",placeholder:"Search snippets...",value:c,onChange:e=>g(e.target.value),className:"w-full px-3 py-1.5 mb-3 rounded-md bg-background border border-border text-sm"}),t.jsx("ul",{className:"space-y-2 flex-grow overflow-y-auto pr-2",children:o.map(e=>t.jsxs("li",{className:"group flex items-center justify-between",children:[t.jsx("button",{onClick:()=>r(e),className:`w-full text-left px-3 py-2 rounded-md ${(s==null?void 0:s.id)===e.id?"bg-primary/10 text-primary":"hover:bg-gray-100"}`,children:e.name}),t.jsxs("div",{className:"flex opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:()=>navigator.clipboard.writeText(e.code),className:"ml-2 p-1 text-text-secondary hover:text-primary",title:"Copy",children:t.jsx(C,{})}),t.jsx("button",{onClick:()=>y(e.id),className:"ml-2 p-1 text-text-secondary hover:text-red-500",title:"Delete",children:t.jsx(S,{})})]})]},e.id))}),t.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:t.jsx("button",{onClick:b,className:"btn-primary w-full text-sm py-2",children:"Add New Snippet"})})]}),t.jsx("main",{className:"w-2/3 flex flex-col",children:s?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f?t.jsx("input",{type:"text",value:s.name,onChange:w,onBlur:()=>m(!1),autoFocus:!0,className:"text-lg font-bold bg-gray-100 rounded px-2"}):t.jsx("h3",{onDoubleClick:()=>m(!0),className:"text-lg font-bold cursor-pointer",children:s.name}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:h,disabled:u,className:"flex items-center gap-2 px-3 py-1 bg-purple-500 text-white font-bold text-xs rounded-md disabled:bg-gray-400",children:[t.jsx(k,{})," AI Enhance"]}),t.jsx("button",{onClick:()=>navigator.clipboard.writeText(s.code),className:"px-3 py-1 bg-gray-100 text-xs rounded-md",children:"Copy"}),t.jsxs("button",{onClick:j,className:"flex items-center gap-1 px-3 py-1 bg-gray-100 text-xs rounded-md",children:[t.jsx(T,{className:"w-4 h-4"})," Download"]})]})]}),t.jsx("textarea",{value:s.code,onChange:e=>d({...s,code:e.target.value}),className:"flex-grow p-4 bg-surface border border-border rounded-md resize-none font-mono text-sm focus:ring-2 focus:ring-primary focus:outline-none"}),t.jsx("div",{className:"mt-2 text-xs text-text-secondary",children:t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"font-bold",children:"Tags:"})," ",(s.tags??[]).map(e=>t.jsx("span",{className:"bg-gray-200 px-2 py-0.5 rounded-full",children:e},e)),t.jsx("input",{type:"text",placeholder:"+ Add tag",onKeyDown:N,className:"bg-transparent border-b border-border focus:outline-none focus:border-primary w-24 text-xs px-1"})]})})]}):t.jsx("div",{className:"flex-grow flex items-center justify-center bg-background border border-border rounded-lg text-text-secondary",children:"Select a snippet or create a new one."})})]})]})};export{R as SnippetVault};
